# ğŸ“§ Mailing List Microservice

![Go Version](https://img.shields.io/badge/go-1.22.2-blue.svg)
![License](https://img.shields.io/badge/license-MIT-green.svg)

A lightweight microservice for managing mailing list subscriptions, confirmations, and soft-deletes. Built in Go with SQLite, designed for modular integration into broader DevOps or cloud orchestration workflows.

## ğŸ“‹ Table of Contents

- [Features](#features)
- [Tech Stack](#tech-stack)
- [Project Structure](#project-structure)
- [Prerequisites](#prerequisites)
- [Installation](#installation)
- [Usage](#usage)
- [API Documentation](#api-documentation)
- [Development](#development)
- [Contributing](#contributing)
- [License](#license)

## âœ¨ Features

- Add, update, confirm, or soft-delete email subscriptions
- Paginated email list querying
- SQLite-backed persistence with auto schema setup
- RESTful API for easy integration
- Supports JSON format for API requests and responses
- Protocol Buffers and gRPC support

## ğŸ› ï¸ Tech Stack

- **Go** (Golang) 1.22.2+
- **SQLite** (via `github.com/mattn/go-sqlite3`)
- **JSON API** for RESTful endpoints
- **Protocol Buffers** for efficient serialization
- **gRPC** for high-performance RPC

## ğŸ“ Project Structure

```
.
â”œâ”€â”€ mdb/            # Database layer with SQLite operations
â”‚   â””â”€â”€ mdb.go      # Core database functionality
â”œâ”€â”€ jsonapi/        # REST API implementation
â”‚   â””â”€â”€ jsonapi.go  # HTTP handlers for JSON endpoints
â”œâ”€â”€ go.mod          # Go module definition
â”œâ”€â”€ go.sum          # Go module checksums
â””â”€â”€ README.md       # Project documentation
```

## ğŸ“‹ Prerequisites

- Go 1.22.2 or higher
- GCC compiler (for SQLite)
- Protocol Buffers compiler (for gRPC)

## ğŸš€ Installation

### 1. Clone the Repository

```bash
git clone https://github.com/yourusername/mailinglist-microservice.git
cd mailinglist-microservice
```

### 2. Install Protocol Buffers Compiler

Install the `protoc` tool by following the official instructions:

- [Official protoc installation guide](https://grpc.io/docs/protoc-installation/)

Alternatively, download a pre-built binary from:

- [Protocol Buffers releases](https://github.com/protocolbuffers/protobuf/releases)

Make sure to place the extracted binary somewhere in your `$PATH`.

### 3. Install Go Protobuf Codegen Tools

```bash
go install google.golang.org/protobuf/cmd/protoc-gen-go@latest
go install google.golang.org/grpc/cmd/protoc-gen-go-grpc@latest
```

### 4. Install Dependencies

```bash
go mod download
```

### 5. Build the Project

```bash
go build -o mailinglist .
```

## ğŸ” Usage

### Running the Service

```bash
./mailinglist
```

The service will start and listen for connections on the configured port.

### Environment Variables

- `PORT`: HTTP server port (default: 8080)
- `DB_PATH`: SQLite database file path (default: ./mailinglist.db)

## ğŸ“š API Documentation

### REST API Endpoints

| Method | Endpoint             | Description                       |
| ------ | -------------------- | --------------------------------- |
| GET    | /emails              | List all email subscriptions      |
| GET    | /emails/{id}         | Get a specific email subscription |
| POST   | /emails              | Create a new email subscription   |
| PUT    | /emails/{id}         | Update an existing subscription   |
| PATCH  | /emails/{id}/confirm | Confirm an email subscription     |
| PATCH  | /emails/{id}/optout  | Opt-out from the mailing list     |

### Example Request

```bash
curl -X POST http://localhost:8080/emails \
  -H "Content-Type: application/json" \
  -d '{"email": "user@example.com"}'
```

## ğŸ’» Development

### Testing

Run the test suite:

```bash
go test ./...
```

### Code Generation

After modifying Protocol Buffer definitions, regenerate the code:

```bash
protoc --go_out=. --go-grpc_out=. proto/*.proto
```

## ğŸ‘¥ Contributing

1. Fork the repository
2. Create your feature branch: `git checkout -b feature/amazing-feature`
3. Commit your changes: `git commit -m 'Add some amazing feature'`
4. Push to the branch: `git push origin feature/amazing-feature`
5. Open a Pull Request

## ğŸ“„ License

This project is licensed under the MIT License - see the LICENSE file for details.
